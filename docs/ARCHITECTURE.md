# ğŸ—ï¸ ì•„í‚¤í…ì²˜ ë¬¸ì„œ

## ê°œìš”

ì´ í”„ë¡œì íŠ¸ëŠ” **Headless WordPress**ë¥¼ CMSë¡œ ì‚¬ìš©í•˜ê³ , **Next.js 14 App Router**ë¥¼ í”„ë¡ íŠ¸ì—”ë“œë¡œ ì‚¬ìš©í•˜ëŠ” **Jamstack ì•„í‚¤í…ì²˜**ì…ë‹ˆë‹¤.

---

## ì‹œìŠ¤í…œ êµ¬ì¡°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ì‚¬ìš©ì (Browser)                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Next.js 14 Frontend                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  App Router (Server Components)                      â”‚  â”‚
â”‚  â”‚  - SSG (Static Site Generation)                      â”‚  â”‚
â”‚  â”‚  - ISR (Incremental Static Regeneration)            â”‚  â”‚
â”‚  â”‚  - Dynamic Metadata                                  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Client Components (í•„ìš”ì‹œë§Œ)                        â”‚  â”‚
â”‚  â”‚  - Pagination                                        â”‚  â”‚
â”‚  â”‚  - CategoryFilter                                    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼ GraphQL
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    WordPress (Headless CMS)                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  WPGraphQL Plugin                                    â”‚  â”‚
â”‚  â”‚  - Posts, Pages, Categories                         â”‚  â”‚
â”‚  â”‚  - Media (Images)                                    â”‚  â”‚
â”‚  â”‚  - SEO Data (RankMath/Yoast)                        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  MySQL Database                                      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ë°ì´í„° íë¦„

### 1. ë¹Œë“œ íƒ€ì„ (SSG)

```
WordPress (GraphQL)
    â”‚
    â–¼ getAllPosts()
Next.js Build Process
    â”‚
    â–¼ generateStaticParams()
Static HTML Files
    â”‚
    â–¼
CDN (Vercel/Cloudflare)
```

### 2. ëŸ°íƒ€ì„ (ISR)

```
User Request
    â”‚
    â–¼
CDN Cache (Hit?)
    â”‚ No
    â–¼
Next.js Server
    â”‚
    â–¼ getContentByURI()
WordPress GraphQL API
    â”‚
    â–¼
Zod Validation
    â”‚
    â–¼
Render Server Component
    â”‚
    â–¼
Update CDN Cache (revalidate: 3600)
```

---

## ë³´ì•ˆ ë ˆì´ì–´

### 1. ì…ë ¥ ê²€ì¦ (Input Validation)

```typescript
// lib/api.ts
const WPContentSchema = z.object({
  title: z.string(),
  content: z.string(),
  // ...
});

const validated = WPContentSchema.safeParse(data);
if (!validated.success) {
  // ì—ëŸ¬ ì²˜ë¦¬
}
```

### 2. HTML ì •ì œ (XSS Defense)

```typescript
// lib/sanitize.ts
export function sanitizeWordPressHTML(html: string): string {
  return html
    .replace(/javascript:/gi, '')
    .replace(/on\w+\s*=\s*["'][^"']*["']/gi, '');
}
```

### 3. í™˜ê²½ë³€ìˆ˜ ê²©ë¦¬

```typescript
// lib/env.ts
const envSchema = z.object({
  WORDPRESS_API_URL: z.string().url(),
  // ...
});

export const env = validateEnv();
```

---

## ì„±ëŠ¥ ìµœì í™”

### 1. Static Site Generation (SSG)

**ì¥ì :**
- âš¡ ì´ˆê³ ì† ë¡œë”© (TTFB < 100ms)
- ğŸ’° ì„œë²„ ë¹„ìš© ì ˆê° (ì •ì  íŒŒì¼)
- ğŸ”’ ë³´ì•ˆ ê°•í™” (ê³µê²© í‘œë©´ ìµœì†Œí™”)

**êµ¬í˜„:**
```typescript
// app/blog/[slug]/page.tsx
export async function generateStaticParams() {
  const posts = await getAllPosts();
  return posts.map((post) => ({ slug: post.slug }));
}
```

### 2. Incremental Static Regeneration (ISR)

**ì¥ì :**
- ğŸ”„ ìë™ ì¬ê²€ì¦ (1ì‹œê°„ë§ˆë‹¤)
- ğŸ“Š ìµœì‹  ë°ì´í„° ìœ ì§€
- âš¡ ì—¬ì „íˆ ë¹ ë¥¸ ë¡œë”©

**êµ¬í˜„:**
```typescript
fetch(url, {
  next: { revalidate: 3600 } // 1ì‹œê°„
});
```

### 3. ì´ë¯¸ì§€ ìµœì í™”

**Next.js Image:**
- âœ… ìë™ WebP ë³€í™˜
- âœ… Lazy Loading
- âœ… Responsive Images
- âœ… CLS ë°©ì–´

```typescript
<Image
  src={imageUrl}
  alt={altText}
  fill
  sizes="(max-width: 768px) 100vw, 50vw"
  priority={index < 3}
/>
```

---

## SEO ì „ëµ

### 1. Metadata ìµœì í™”

```typescript
export async function generateMetadata(): Promise<Metadata> {
  return {
    title: seoTitle,
    description: seoDescription,
    openGraph: { /* ... */ },
    twitter: { /* ... */ },
    alternates: {
      canonical: canonicalUrl,
    },
  };
}
```

### 2. JSON-LD Structured Data

```json
{
  "@context": "https://schema.org",
  "@type": "Article",
  "headline": "ì œëª©",
  "author": {
    "@type": "Person",
    "name": "ì‘ì„±ì"
  },
  "datePublished": "2024-01-01",
  "image": "https://..."
}
```

### 3. Semantic HTML

```html
<article>
  <header>
    <h1>ì œëª©</h1>
    <p class="lead">ìš”ì•½ (Snippet Trap)</p>
  </header>
  <section>
    <h2>ì„¹ì…˜ ì œëª©</h2>
    <p>ë‚´ìš©...</p>
  </section>
</article>
```

---

## ì—ëŸ¬ ì²˜ë¦¬

### 1. WordPress API ì‹¤íŒ¨

```typescript
try {
  const data = await getContentByURI(uri);
  if (!data) {
    notFound(); // 404 í˜ì´ì§€
  }
} catch (error) {
  console.error('API Error:', error);
  return null; // Fallback
}
```

### 2. ì´ë¯¸ì§€ ë¡œë”© ì‹¤íŒ¨

```typescript
const imageUrl = validateImageUrl(sourceUrl);
if (!imageUrl) {
  return <div className="bg-muted aspect-video" />;
}
```

### 3. ê²€ì¦ ì‹¤íŒ¨

```typescript
const validated = WPContentSchema.safeParse(data);
if (!validated.success) {
  console.error('Validation Error:', validated.error);
  return null;
}
```

---

## í™•ì¥ ê°€ëŠ¥ì„±

### 1. ë‹¤êµ­ì–´ ì§€ì› (i18n)

```typescript
// app/[locale]/blog/page.tsx
export async function generateStaticParams() {
  return [
    { locale: 'ko' },
    { locale: 'en' },
  ];
}
```

### 2. ëŒ“ê¸€ ì‹œìŠ¤í…œ

```typescript
// components/blog/Comments.tsx
'use client';

export function Comments({ postId }: { postId: number }) {
  // Disqus, Utterances, Giscus ë“±
}
```

### 3. ê²€ìƒ‰ ê¸°ëŠ¥

```typescript
// app/search/page.tsx
export default async function SearchPage({ searchParams }) {
  const query = searchParams.q;
  const results = await searchPosts(query);
  // ...
}
```

---

## ë°°í¬ ì „ëµ

### Vercel (ê¶Œì¥)

```bash
# 1. Vercel CLI ì„¤ì¹˜
npm i -g vercel

# 2. ë°°í¬
vercel

# 3. í™˜ê²½ë³€ìˆ˜ ì„¤ì •
vercel env add WORDPRESS_API_URL
```

### Docker

```dockerfile
FROM node:20-alpine
WORKDIR /app
COPY package*.json ./
RUN npm ci
COPY . .
RUN npm run build
CMD ["npm", "start"]
```

---

## ëª¨ë‹ˆí„°ë§

### 1. Core Web Vitals

- **LCP (Largest Contentful Paint)**: < 2.5s
- **FID (First Input Delay)**: < 100ms
- **CLS (Cumulative Layout Shift)**: < 0.1

### 2. ì—ëŸ¬ ì¶”ì 

```typescript
// Sentry, LogRocket ë“± í†µí•©
if (error) {
  console.error('[Error]', error);
  // Sentry.captureException(error);
}
```

---

## ìœ ì§€ë³´ìˆ˜

### 1. WordPress ì—…ë°ì´íŠ¸

- âœ… í”ŒëŸ¬ê·¸ì¸ ì—…ë°ì´íŠ¸ (WPGraphQL)
- âœ… í…Œë§ˆ ì—…ë°ì´íŠ¸ (ì‚¬ìš© ì•ˆ í•¨)
- âœ… ë³´ì•ˆ íŒ¨ì¹˜

### 2. Next.js ì—…ë°ì´íŠ¸

```bash
npm update next react react-dom
npm run build
npm test
```

### 3. ì˜ì¡´ì„± ê´€ë¦¬

```bash
# ë³´ì•ˆ ì·¨ì•½ì  í™•ì¸
npm audit

# ìë™ ìˆ˜ì •
npm audit fix
```

---

## ì°¸ê³  ìë£Œ

- [Next.js 14 Documentation](https://nextjs.org/docs)
- [WPGraphQL Documentation](https://www.wpgraphql.com/)
- [Zod Documentation](https://zod.dev/)
- [Shadcn/UI Documentation](https://ui.shadcn.com/)
